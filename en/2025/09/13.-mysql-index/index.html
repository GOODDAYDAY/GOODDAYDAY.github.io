<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>[MySQL] 3. MySQL Index - GoodyHao's Blog</title><meta name=Description content="Elegance Never Fades"><meta property="og:url" content="https://gooddayday.github.io/en/2025/09/13.-mysql-index/"><meta property="og:site_name" content="GoodyHao's Blog"><meta property="og:title" content="[MySQL] 3. MySQL Index"><meta property="og:description" content="[MySQL] 3. MySQL Index What is an Index? Index is a data structure that improves the speed of data retrieval operations on a database table at the cost of additional writes and storage space to maintain the index data structure. Index Types By Data Structure Hash Index Hash Index is based on a hash table data structure. It uses a hash function to map keys to specific locations in the hash table, allowing for very fast data retrieval. Algorithm Complexity: O(1) Advantages: Very fast for equality searches (e.g., =). Disadvantages: Not suitable for range queries (e.g., <, >, BETWEEN). Hash collisions can occur, leading to performance degradation. why not support order by let us see the algorithm of hash index"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-09-28T21:02:17+08:00"><meta property="article:modified_time" content="2025-10-02T13:51:49+08:00"><meta property="article:tag" content="MySQL"><meta property="article:tag" content="Index"><meta property="og:image" content="https://gooddayday.github.io/logo.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://gooddayday.github.io/logo.jpg"><meta name=twitter:title content="[MySQL] 3. MySQL Index"><meta name=twitter:description content="[MySQL] 3. MySQL Index What is an Index? Index is a data structure that improves the speed of data retrieval operations on a database table at the cost of additional writes and storage space to maintain the index data structure. Index Types By Data Structure Hash Index Hash Index is based on a hash table data structure. It uses a hash function to map keys to specific locations in the hash table, allowing for very fast data retrieval. Algorithm Complexity: O(1) Advantages: Very fast for equality searches (e.g., =). Disadvantages: Not suitable for range queries (e.g., <, >, BETWEEN). Hash collisions can occur, leading to performance degradation. why not support order by let us see the algorithm of hash index"><meta name=application-name content="LoveIt"><meta name=apple-mobile-web-app-title content="LoveIt"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://gooddayday.github.io/en/2025/09/13.-mysql-index/><link rel=prev href=https://gooddayday.github.io/en/2025/09/12.-mysql-lock/><link rel=next href=https://gooddayday.github.io/en/2025/10/14.-spring-async-threadpool-and-thread-reuse/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"[MySQL] 3. MySQL Index","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/gooddayday.github.io\/en\/2025\/09\/13.-mysql-index\/"},"image":["https:\/\/gooddayday.github.io\/images\/Apple-Devices-Preview.png"],"genre":"posts","keywords":"MySQL, Index","wordcount":2288,"url":"https:\/\/gooddayday.github.io\/en\/2025\/09\/13.-mysql-index\/","datePublished":"2025-09-28T21:02:17+08:00","dateModified":"2025-10-02T13:51:49+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"xxxx","logo":"https:\/\/gooddayday.github.io\/images\/logo.jpg"},"author":{"@type":"Person","name":"GoodyHao"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"light"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"light"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/en/ title="GoodyHao's Blog"><span class=header-title-pre><i class='far fa-kiss-wink-heart fa-fw' aria-hidden=true></i></span>Elegance Never Fades</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/en/posts/>Posts </a><a class=menu-item href=/en/tags/>Tags </a><a class=menu-item href=/en/categories/>Categories </a><a class=menu-item href=/en/categories/documentation/>Docs </a><a class=menu-item href=/en/about/>About </a><a class=menu-item href=https://github.com/GOODDAYDAY/GOODDAYDAY.github.io title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a class=menu-item href=/zh-cn/2025/09/13.-mysql-index/ title=简体中文>中文</a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/en/ title="GoodyHao's Blog"><span class=header-title-pre><i class='far fa-kiss-wink-heart fa-fw' aria-hidden=true></i></span>Elegance Never Fades</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/en/posts/ title>Posts</a><a class=menu-item href=/en/tags/ title>Tags</a><a class=menu-item href=/en/categories/ title>Categories</a><a class=menu-item href=/en/categories/documentation/ title>Docs</a><a class=menu-item href=/en/about/ title>About</a><a class=menu-item href=https://github.com/GOODDAYDAY/GOODDAYDAY.github.io title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a class=menu-item href=/zh-cn/2025/09/13.-mysql-index/ title=简体中文>中文</a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">[MySQL] 3. MySQL Index</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/en/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>GoodyHao</a></span>&nbsp;<span class=post-category>included in <a href=/en/categories/mysql/><i class="far fa-folder fa-fw" aria-hidden=true></i>MySQL</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2025-09-28>2025-09-28</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;2288 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;11 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#what-is-an-index>What is an Index?</a></li><li><a href=#index-types>Index Types</a><ul><li><a href=#by-data-structure>By Data Structure</a><ul><li><a href=#hash-index>Hash Index</a><ul><li><a href=#why-not-support-order-by>why not support <code>order by</code></a></li></ul></li><li><a href=#btreeb-tree-index>BTree(B-Tree) Index</a><ul><li><a href=#why-not-avl-or-red-black-tree>why not AVL or Red-Black Tree</a></li><li><a href=#why-btree>Why BTree</a></li></ul></li><li><a href=#btree-index>B+Tree Index</a></li></ul></li><li><a href=#by-usage>By Usage</a><ul><li><a href=#primary-key-index>Primary Key Index</a></li><li><a href=#composite-index>Composite Index</a></li><li><a href=#secondary-index-non-clustered-index>Secondary Index (Non-Clustered Index)</a><ul><li><a href=#covering-index-vs-table-lookup>Covering Index vs Table Lookup</a></li><li><a href=#table-lookup-process>Table Lookup Process</a></li></ul></li><li><a href=#full-text-index>Full-Text Index</a><ul><li><a href=#key-differences-from-btree-index>Key Differences from B+Tree Index</a></li><li><a href=#inverted-index-mechanism>Inverted Index Mechanism</a></li><li><a href=#supported-data-types>Supported Data Types</a></li><li><a href=#create-table-grammar>Create Table Grammar</a></li><li><a href=#search-modes>Search Modes</a><ul><li><a href=#natural-language-mode-default>Natural Language Mode (Default)</a></li><li><a href=#boolean-mode>Boolean Mode</a></li></ul></li></ul></li></ul></li></ul></li><li><a href=#advanced-index-optimization-concepts>Advanced Index Optimization Concepts</a><ul><li><a href=#table-structure-and-index>Table Structure and Index</a></li><li><a href=#covering-index>Covering Index</a><ul><li><a href=#not-covering-index-table-lookup-for-other-columns-return>Not Covering Index: table lookup for other columns return</a></li><li><a href=#not-covering-index-table-lookup-for-other-columns-as-conditions>Not Covering Index: table lookup for other columns as conditions</a></li><li><a href=#covering-index-success>Covering Index success</a></li></ul></li><li><a href=#index-condition-pushdown>Index Condition Pushdown</a><ul><li><a href=#not-icp--just-one-condition>Not ICP : Just one condition</a></li><li><a href=#icp-success>ICP Success</a></li></ul></li><li><a href=#key-lookup>Key Lookup</a><ul><li><a href=#key-lookup--return-more-columns>Key Lookup : return more columns</a></li><li><a href=#key-lookup--conditions-contain-more-column>Key Lookup : conditions contain more column</a></li><li><a href=#not-key-lookupgood>Not Key Lookup(Good)</a></li></ul></li></ul></li><li><a href=#index-usage-experience>Index Usage Experience</a><ul><li><a href=#when-to-use-hash-index>When to Use Hash Index</a></li><li><a href=#filter-rate-is-the-point-for-index-usage>Filter rate is the point for index usage</a><ul><li><a href=#classic-question-id-begin-end-vs-id-end-begin>Classic Question: (id, begin, end) vs (id, end, begin)</a><ul><li><a href=#find-the-actives-coupons>find the actives coupons.</a></li></ul></li><li><a href=#classic-question-types-index>Classic Question: types index</a><ul><li><a href=#nearly-average-like-computer-types>nearly average like computer types</a></li><li><a href=#not-average-like-payment-status>not average like payment status</a></li></ul></li></ul></li><li><a href=#data-size-vs-index-size>Data Size VS Index Size</a></li><li><a href=#do-not-modify-index-column-frequently>Do not modify index column frequently</a></li></ul></li></ul></nav></div></div><div class=content id=content><h1 id=mysql-3-mysql-index>[MySQL] 3. MySQL Index</h1><h2 id=what-is-an-index>What is an Index?</h2><ul><li>Index is a data structure that improves the speed of data retrieval operations on a database table at the cost of additional writes and storage space to maintain the index data structure.</li></ul><h2 id=index-types>Index Types</h2><h3 id=by-data-structure>By Data Structure</h3><h4 id=hash-index>Hash Index</h4><ul><li>Hash Index is based on a hash table data structure. It uses a hash function to map keys to specific locations in the hash table, allowing for very fast data retrieval.</li><li>Algorithm Complexity: O(1)</li><li>Advantages:<ul><li>Very fast for equality searches (e.g., <code>=</code>).</li></ul></li><li>Disadvantages:<ul><li>Not suitable for range queries (e.g., <code>&lt;</code>, <code>></code>, <code>BETWEEN</code>).</li><li>Hash collisions can occur, leading to performance degradation.</li></ul></li></ul><h5 id=why-not-support-order-by>why not support <code>order by</code></h5><ul><li>let us see the algorithm of hash index</li></ul><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/13.%20mysql%20index/6.%20hash%20function.svg data-srcset="/images/13.%20mysql%20index/6.%20hash%20function.svg, /images/13.%20mysql%20index/6.%20hash%20function.svg 1.5x, /images/13.%20mysql%20index/6.%20hash%20function.svg 2x" data-sizes=auto alt=/images/13.%20mysql%20index/6.%20hash%20function.svg title="6. hash function.svg"></p><ul><li>We see that hash index which is k-v structure. So v is not sorted, so it can not support <code>order by</code>.</li></ul><h4 id=btreeb-tree-index>BTree(B-Tree) Index</h4><h5 id=why-not-avl-or-red-black-tree>why not AVL or Red-Black Tree</h5><ul><li>As to Tree Index, we can think about balanced search tree like AVL tree or Red-Black tree<ul><li>Algorithm Complexity: O(log n)</li></ul></li></ul><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/13.%20mysql%20index/4.%20AVL.svg data-srcset="/images/13.%20mysql%20index/4.%20AVL.svg, /images/13.%20mysql%20index/4.%20AVL.svg 1.5x, /images/13.%20mysql%20index/4.%20AVL.svg 2x" data-sizes=auto alt=/images/13.%20mysql%20index/4.%20AVL.svg title="4. AVL.svg"> <img class=lazyload src=/svg/loading.min.svg data-src=/images/13.%20mysql%20index/5.%20Red-Black.svg data-srcset="/images/13.%20mysql%20index/5.%20Red-Black.svg, /images/13.%20mysql%20index/5.%20Red-Black.svg 1.5x, /images/13.%20mysql%20index/5.%20Red-Black.svg 2x" data-sizes=auto alt=/images/13.%20mysql%20index/5.%20Red-Black.svg title="5. Red-Black.svg"></p><ul><li>Obviously, they are binary balance search tree which is not suitable for database index because:<ul><li>High tree height: Binary trees can become tall, leading to increased search times.</li><li>Frequent rebalancing: Insertions and deletions often require tree rotations to maintain balance, which can be costly in terms of performance.</li><li>Poor disk I/O performance: Binary trees do not take advantage of spatial locality, leading to inefficient disk access patterns.<ul><li>Disk I/O cost much more than memory access.</li></ul></li></ul></li></ul><h5 id=why-btree>Why BTree</h5><ul><li>So, to reduce the tree height and disk I/O, BTree comes out naturally.<ul><li>Firstly, multi-way tree is used to reduce the tree height.</li><li>Secondly, each node contains entire disk page data to reduce the disk I/O.</li></ul></li></ul><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/13.%20mysql%20index/3.%20btree_index.svg data-srcset="/images/13.%20mysql%20index/3.%20btree_index.svg, /images/13.%20mysql%20index/3.%20btree_index.svg 1.5x, /images/13.%20mysql%20index/3.%20btree_index.svg 2x" data-sizes=auto alt=/images/13.%20mysql%20index/3.%20btree_index.svg title="3. btree_index.svg"></p><ul><li>But we still have some problems:<ul><li>When we insert or delete data, the tree may become unbalanced.</li><li>It is hard to search in order that we need to use in-order traversal, much cost, to get sorted data.</li><li>So, B+Tree comes out.</li></ul></li></ul><h4 id=btree-index>B+Tree Index</h4><ul><li>Firstly, B+Tree reduce the tree node size by only storing keys in internal nodes, which allows more keys to fit in memory and reduces tree height.<ul><li>no value means more keys in one node => less tree height => less disk I/O</li></ul></li><li>Secondly, B+Tree stores all actual data in leaf nodes, which are linked together in a linked list, so that range queries more efficient.</li></ul><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/13.%20mysql%20index/1.%20single_index.svg data-srcset="/images/13.%20mysql%20index/1.%20single_index.svg, /images/13.%20mysql%20index/1.%20single_index.svg 1.5x, /images/13.%20mysql%20index/1.%20single_index.svg 2x" data-sizes=auto alt=/images/13.%20mysql%20index/1.%20single_index.svg title="1. single_index.svg"></p><h3 id=by-usage>By Usage</h3><h4 id=primary-key-index>Primary Key Index</h4><ul><li>Primary key index is automatically created for primary key columns. If there is no primary key, MySQL will create one.</li><li>Ensures uniqueness and fast access to records, because only one action can get the entire record.</li><li>Primary Key is B+Tree</li></ul><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/13.%20mysql%20index/2.%20composite_index.svg data-srcset="/images/13.%20mysql%20index/2.%20composite_index.svg, /images/13.%20mysql%20index/2.%20composite_index.svg 1.5x, /images/13.%20mysql%20index/2.%20composite_index.svg 2x" data-sizes=auto alt=/images/13.%20mysql%20index/2.%20composite_index.svg title="2. composite_index.svg"></p><h4 id=composite-index>Composite Index</h4><ul><li>We know MySQL support composite index which is index on multiple columns.</li></ul><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/13.%20mysql%20index/2.%20composite_index.svg data-srcset="/images/13.%20mysql%20index/2.%20composite_index.svg, /images/13.%20mysql%20index/2.%20composite_index.svg 1.5x, /images/13.%20mysql%20index/2.%20composite_index.svg 2x" data-sizes=auto alt=/images/13.%20mysql%20index/2.%20composite_index.svg title="2. composite_index.svg"></p><ul><li><p>Let us see the single leaf pages.</p><ul><li>The leaf pages are sorted by the first column, and then by the second column.<ul><li>{column A, column B} : (1, 1), (1, 2), (2, 1), (2, 2), (3, 1), (3, 2)</li></ul></li></ul></li><li><p>So, let us thinking the classical question: (leftmost prefix rule)</p><ul><li>If we have a composite index on (A, B), can we use it for query <code>where B = 1</code>?<ul><li>No, because the leaf pages are sorted by A first, then B. So we can not find all B = 1 quickly.</li></ul></li><li>If we have a composite index on (A, B), can we use it for query <code>where A = 1 AND B > 1</code>?<ul><li>Yes, because we can find A = 1 quickly, then we get <code>(1, 1), (1, 2)</code> which means B is in order, so we can find B > 1 quickly.</li></ul></li><li>If we have a composite index on (A, B), can we use it for query <code>where A > 1 AND B > 1</code>?<ul><li>Yes, but only A > 1 is used. Because we will get <code>(2, 1), (2, 2), (3, 1), (3, 2)</code> which means B is not in order.</li></ul></li></ul></li></ul><h4 id=secondary-index-non-clustered-index>Secondary Index (Non-Clustered Index)</h4><ul><li>Secondary index is also called non-clustered index, which is different from clustered index (primary key index).</li><li><strong>Key Difference</strong>: Secondary index leaf nodes only store <strong>index columns + primary key values</strong>, not the complete row data.</li><li><strong>Index Structure</strong>: B+Tree structure, but leaf nodes contain references to primary key instead of full row data.</li></ul><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/13.%20mysql%20index/8.%20secondary_index.svg data-srcset="/images/13.%20mysql%20index/8.%20secondary_index.svg, /images/13.%20mysql%20index/8.%20secondary_index.svg 1.5x, /images/13.%20mysql%20index/8.%20secondary_index.svg 2x" data-sizes=auto alt=/images/13.%20mysql%20index/8.%20secondary_index.svg title="8. secondary_index.svg"></p><h5 id=covering-index-vs-table-lookup>Covering Index vs Table Lookup</h5><ul><li><p><strong>Covering Index</strong>: When query fields are all included in the secondary index, no table lookup needed.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- Index: idx_AB (A, B)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>  </span><span class=c1>-- ✅ Covering index, no lookup
</span></span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Table Lookup</strong>: When query needs fields not in the secondary index, must lookup primary key.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- Index: idx_AB (A, B), but need field C
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>  </span><span class=c1>-- ❌ Need table lookup for field C
</span></span></span></code></pre></td></tr></table></div></div></li></ul><h5 id=table-lookup-process>Table Lookup Process</h5><ol><li><strong>Search Secondary Index</strong>: Find matching records, get primary key values</li><li><strong>Lookup Primary Index</strong>: Use primary key to fetch complete row data from clustered index</li><li><strong>Return Results</strong>: Combine data from both indexes</li></ol><p>This is why <code>SELECT *</code> often requires table lookup, while selecting only indexed columns can avoid it.</p><h4 id=full-text-index>Full-Text Index</h4><ul><li>Full-Text index is designed to solve finding words in large text problems using <strong>inverted index</strong> structure.</li></ul><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/13.%20mysql%20index/7.%20fulltext_index-Full_Text_Index.svg data-srcset="/images/13.%20mysql%20index/7.%20fulltext_index-Full_Text_Index.svg, /images/13.%20mysql%20index/7.%20fulltext_index-Full_Text_Index.svg 1.5x, /images/13.%20mysql%20index/7.%20fulltext_index-Full_Text_Index.svg 2x" data-sizes=auto alt=/images/13.%20mysql%20index/7.%20fulltext_index-Full_Text_Index.svg title="7. fulltext_index-Full_Text_Index.svg"></p><h5 id=key-differences-from-btree-index>Key Differences from B+Tree Index</h5><table><thead><tr><th>Feature</th><th>B+Tree Index</th><th>Full-Text Index</th></tr></thead><tbody><tr><td><strong>Data Structure</strong></td><td>Balanced tree</td><td>Inverted index (word → documents)</td></tr><tr><td><strong>Storage</strong></td><td>Complete row data in leaves</td><td>Word-to-document mappings</td></tr><tr><td><strong>Query Type</strong></td><td>Exact match, range queries</td><td>Text search, relevance ranking</td></tr><tr><td><strong>Complexity</strong></td><td>O(log n)</td><td>Depends on word frequency</td></tr></tbody></table><h5 id=inverted-index-mechanism>Inverted Index Mechanism</h5><ol><li><strong>Tokenization</strong>: Split text into individual words</li><li><strong>Word Mapping</strong>: Create word → document list mappings</li><li><strong>Search Process</strong>: Find documents containing query words</li><li><strong>Intersection</strong>: Combine results for multi-word queries</li></ol><h5 id=supported-data-types>Supported Data Types</h5><ul><li><code>CHAR</code></li><li><code>VARCHAR</code></li><li><code>TEXT</code></li></ul><h5 id=create-table-grammar>Create Table Grammar</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- Single column full-text index
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>title</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>255</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>content</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>FULLTEXT</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=n>ft_content</span><span class=w> </span><span class=p>(</span><span class=n>content</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=o>=</span><span class=n>InnoDB</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Multi-column full-text index
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>title</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>255</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>content</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>FULLTEXT</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=n>ft_title_content</span><span class=w> </span><span class=p>(</span><span class=n>title</span><span class=p>,</span><span class=w> </span><span class=n>content</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=o>=</span><span class=n>InnoDB</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=search-modes>Search Modes</h5><h6 id=natural-language-mode-default>Natural Language Mode (Default)</h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=k>MATCH</span><span class=p>(</span><span class=n>title</span><span class=p>,</span><span class=w> </span><span class=n>content</span><span class=p>)</span><span class=w> </span><span class=n>AGAINST</span><span class=p>(</span><span class=s1>&#39;MySQL optimization&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- With relevance score
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=p>,</span><span class=w> </span><span class=k>MATCH</span><span class=p>(</span><span class=n>title</span><span class=p>,</span><span class=w> </span><span class=n>content</span><span class=p>)</span><span class=w> </span><span class=n>AGAINST</span><span class=p>(</span><span class=s1>&#39;MySQL optimization&#39;</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>score</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=k>MATCH</span><span class=p>(</span><span class=n>title</span><span class=p>,</span><span class=w> </span><span class=n>content</span><span class=p>)</span><span class=w> </span><span class=n>AGAINST</span><span class=p>(</span><span class=s1>&#39;MySQL optimization&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h6 id=boolean-mode>Boolean Mode</h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- Must contain &#34;MySQL&#34;, must not contain &#34;Oracle&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=k>MATCH</span><span class=p>(</span><span class=n>title</span><span class=p>,</span><span class=w> </span><span class=n>content</span><span class=p>)</span><span class=w> </span><span class=n>AGAINST</span><span class=p>(</span><span class=s1>&#39;+MySQL -Oracle&#39;</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=nb>BOOLEAN</span><span class=w> </span><span class=k>MODE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Exact phrase search
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=k>MATCH</span><span class=p>(</span><span class=n>title</span><span class=p>,</span><span class=w> </span><span class=n>content</span><span class=p>)</span><span class=w> </span><span class=n>AGAINST</span><span class=p>(</span><span class=s1>&#39;&#34;index optimization&#34;&#39;</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=nb>BOOLEAN</span><span class=w> </span><span class=k>MODE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Wildcard search
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=k>MATCH</span><span class=p>(</span><span class=n>title</span><span class=p>,</span><span class=w> </span><span class=n>content</span><span class=p>)</span><span class=w> </span><span class=n>AGAINST</span><span class=p>(</span><span class=s1>&#39;optim*&#39;</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=nb>BOOLEAN</span><span class=w> </span><span class=k>MODE</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=advanced-index-optimization-concepts>Advanced Index Optimization Concepts</h2><p>Let&rsquo;s analyze various SQL queries to understand <strong>Covering Index</strong>, <strong>Index Condition Pushdown (ICP)</strong>, and <strong>Key Lookup (回表)</strong> behaviors.</p><h3 id=table-structure-and-index>Table Structure and Index</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>A</span><span class=w> </span><span class=nb>BIGINT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>B</span><span class=w> </span><span class=nb>BIGINT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>C</span><span class=w> </span><span class=nb>BIGINT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>D</span><span class=w> </span><span class=nb>BIGINT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=o>=</span><span class=n>InnoDB</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Composite index on columns A, B, C
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_articles_query</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=p>(</span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=k>C</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>Index Structure</strong>: <code>idx_articles_query (A, B, C)</code>(secondary index) + Primary Key <code>id</code> (automatically included in secondary indexes)</p><h3 id=covering-index>Covering Index</h3><ul><li><strong>Covering Index</strong>: When all query columns are included in the index, eliminating the need for table lookup.</li><li>So, if the query need a table lookup, it must not be a <code>Covering Index</code></li></ul><h4 id=not-covering-index-table-lookup-for-other-columns-return>Not Covering Index: table lookup for other columns return</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=k>C</span><span class=p>,</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=k>C</span><span class=p>,</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=not-covering-index-table-lookup-for-other-columns-as-conditions>Not Covering Index: table lookup for other columns as conditions</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=k>C</span><span class=p>,</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=covering-index-success>Covering Index success</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=index-condition-pushdown>Index Condition Pushdown</h3><p><strong>ICP</strong>: Pushes WHERE conditions that can use the index down to the storage engine level, reducing table lookups.</p><h4 id=not-icp--just-one-condition>Not ICP : Just one condition</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=icp-success>ICP Success</h4><p><strong>even skip one index column</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>even has other index column</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=k>C</span><span class=p>,</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>normal</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=k>C</span><span class=p>,</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=key-lookup>Key Lookup</h3><ul><li>Secondary index only save <code>id</code> that key lookup will occur if there has other column.</li><li>Key Lookup is the action we <code>need to avoid</code>. Because it cost more.</li></ul><h4 id=key-lookup--return-more-columns>Key Lookup : return more columns</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=k>C</span><span class=p>,</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=k>C</span><span class=p>,</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=key-lookup--conditions-contain-more-column>Key Lookup : conditions contain more column</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=k>C</span><span class=p>,</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=not-key-lookupgood>Not Key Lookup(Good)</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>id contains in secondary index leaf</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=index-usage-experience>Index Usage Experience</h2><h3 id=when-to-use-hash-index>When to Use Hash Index</h3><ol><li>Just search <code>one</code> picture.</li><li>The column content nearly random or unrelated, such as UUID.</li></ol><h3 id=filter-rate-is-the-point-for-index-usage>Filter rate is the point for index usage</h3><ol><li>If reusable, index should be less.</li><li>The index design is point to more filter rate.</li></ol><h4 id=classic-question-id-begin-end-vs-id-end-begin>Classic Question: (id, begin, end) vs (id, end, begin)</h4><ul><li>coupons table</li></ul><table><thead><tr><th style=text-align:center>user_id</th><th>begin</th><th>end</th></tr></thead><tbody><tr><td style=text-align:center>~</td><td>~</td><td>~</td></tr><tr><td style=text-align:center>7</td><td>1234567890000</td><td>1234567890100</td></tr><tr><td style=text-align:center>7</td><td>1234567891000</td><td>1234567891100</td></tr><tr><td style=text-align:center>7</td><td>1234567892000</td><td>1234567892100</td></tr><tr><td style=text-align:center>7</td><td>1234567893000</td><td>1234567893100</td></tr><tr><td style=text-align:center>7</td><td>1234567894000</td><td>1234567894100</td></tr><tr><td style=text-align:center>7</td><td>1234567895000</td><td>1234567895100</td></tr><tr><td style=text-align:center>7</td><td>1234567896000</td><td>1234567896100</td></tr><tr><td style=text-align:center>7</td><td>1234567897000</td><td>1234567897100</td></tr><tr><td style=text-align:center>7</td><td>1234567898000</td><td>1234567898100</td></tr><tr><td style=text-align:center>~</td><td>~</td><td>~</td></tr></tbody></table><h5 id=find-the-actives-coupons>find the actives coupons.</h5><ul><li>Let us analysis if we search the below SQL.<ul><li>SELECT * FROM <code>table</code> WHERE id = 7 AND begin &lt; 1234567894000 AND end > 1234567894000</li></ul></li></ul><ol><li><code>Index Condition Pushdown</code> can be used for this query.</li><li>Only <code>first two column index</code> can be used which is (id, begin) in (id, begin, end) or (id, end) in (id, end, begin).</li><li>But, as to (id, begin) part, begin > 1234567894000 always filter less data, which the time always be <code>now</code>.<ul><li>Because there are always data begin less than now.</li></ul></li><li>As to (id, end) part, end > 1234567894000 always filter more data, which time always be <code>now</code>.</li></ol><blockquote><p>So the better one is (id, end, begin)</p></blockquote><h4 id=classic-question-types-index>Classic Question: types index</h4><ul><li>Assume there are 5 types</li></ul><h5 id=nearly-average-like-computer-types>nearly average like computer types</h5><ul><li>INDEX idx_computer_type(type)</li><li>In this situation, when we use type = 1, just nearly 20% filter rate.</li></ul><h5 id=not-average-like-payment-status>not average like payment status</h5><ul><li>INDEX idx_payment_status(status)</li><li>In this situation, almost payment will be status = final.</li><li><code>But</code> we always query the status != final which just occupy a little data like less than 1% (nearly more than 99% filter rate).</li></ul><h3 id=data-size-vs-index-size>Data Size VS Index Size</h3><ul><li>People always think that if data is just a little, there is no need to create index.</li><li>When data is not large, it does not matter if we have many indexes.<ul><li>Because indexes will not use much storage.</li></ul></li><li>When data is large, it does not matter if we have many indexes.<ul><li>Because indexes will be important for us to query quickly.</li></ul></li></ul><h3 id=do-not-modify-index-column-frequently>Do not modify index column frequently</h3><ul><li>We know the index is balanced and in order. If we modify the index column value, the B+Tree need to rebalance itself which cost much.</li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2025-10-02&nbsp;<a class=git-hash href=https://github.com/GOODDAYDAY/GOODDAYDAY.github.io/commit/2e18c300b2ee848f2953b2e4671d9a9d358d100f target=_blank title="commit by haotian(haotian@codemao.cn) 2e18c300b2ee848f2953b2e4671d9a9d358d100f: Enhance bilingual support and content structure in documentation">
<i class="fas fa-hashtag fa-fw" aria-hidden=true></i>2e18c30</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/en/2025/09/13.-mysql-index/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://gooddayday.github.io/en/2025/09/13.-mysql-index/ data-title="[MySQL] 3. MySQL Index" data-hashtags=MySQL,Index><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://gooddayday.github.io/en/2025/09/13.-mysql-index/ data-hashtag=MySQL><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://gooddayday.github.io/en/2025/09/13.-mysql-index/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://gooddayday.github.io/en/2025/09/13.-mysql-index/ data-title="[MySQL] 3. MySQL Index"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://gooddayday.github.io/en/2025/09/13.-mysql-index/ data-title="[MySQL] 3. MySQL Index"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://gooddayday.github.io/en/2025/09/13.-mysql-index/ data-title="[MySQL] 3. MySQL Index"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/en/tags/mysql/>MySQL</a>,&nbsp;<a href=/en/tags/index/>Index</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/en/>Home</a></span></section></div><div class=post-nav><a href=/en/2025/09/12.-mysql-lock/ class=prev rel=prev title="[MySQL] 2. Lock Mechanism Execution Analysis"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>[MySQL] 2. Lock Mechanism Execution Analysis</a>
<a href=/en/2025/10/14.-spring-async-threadpool-and-thread-reuse/ class=next rel=next title="[Spring] 2. Analysis of Custom Thread Pools and Thread Reuse in Spring Async Interfaces">[Spring] 2. Analysis of Custom Thread Pools and Thread Reuse in Spring Async Interfaces<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=giscus class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app>Giscus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><span class=author itemprop=copyrightHolder>&nbsp;<a href=/en/ target=_blank>GoodyHao</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/css/auto-numbering.css><link rel=stylesheet href=/css/svg-fullwidth.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{giscus:{category:"Announcements",categoryId:"DIC_kwDOPtWtCc4CvteQ",darkTheme:"dark",emitMetadata:"0",inputPosition:"bottom",lang:"en",lazyLoading:!1,lightTheme:"light",mapping:"pathname",reactionsEnabled:"1",repo:"GOODDAYDAY/GOODDAYDAY.github.io",repoId:"R_kgDOPtWtCQ"}},search:{algoliaAppID:"PASDMWALPK",algoliaIndex:"index.en",algoliaSearchKey:"b42948e51daaa93df92381c8e2ac0f93",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>