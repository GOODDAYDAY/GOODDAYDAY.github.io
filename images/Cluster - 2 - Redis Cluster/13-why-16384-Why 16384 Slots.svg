<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="270px" preserveAspectRatio="none" style="width:1425px;height:270px;background:#FEFEFE;" version="1.1" viewBox="0 0 1425 270" width="1425px" zoomAndPan="magnify"><title>Why 16384 Slots? The Trade-off Game</title><defs/><g><rect fill="#FEFEFE" height="270" style="stroke:none;stroke-width:1.0;" width="1425" x="0" y="0"/><text fill="#000000" font-family="Arial" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="400.9844" x="507.8784" y="35.6357">Why 16384 Slots? The Trade-off Game</text><!--cluster optionA--><g id="cluster_optionA"><path d="M13.5,57.2979 L225.9814,57.2979 A3.75,3.75 0 0 1 228.4814,59.7979 L235.4814,75.9468 L435.5,75.9468 A2.5,2.5 0 0 1 438,78.4468 L438,260.7979 A2.5,2.5 0 0 1 435.5,263.2979 L13.5,263.2979 A2.5,2.5 0 0 1 11,260.7979 L11,59.7979 A2.5,2.5 0 0 1 13.5,57.2979 " fill="#FFEBEE" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="11" x2="235.4814" y1="75.9468" y2="75.9468"/><text fill="#000000" font-family="Arial" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="211.4814" x="15" y="69.6157">Option A: 65536 slots (CRC16 full range)</text></g><!--cluster optionB--><g id="cluster_optionB"><path d="M750.5,57.2979 L942.2114,57.2979 A3.75,3.75 0 0 1 944.7114,59.7979 L951.7114,75.9468 L1172.5,75.9468 A2.5,2.5 0 0 1 1175,78.4468 L1175,260.7979 A2.5,2.5 0 0 1 1172.5,263.2979 L750.5,263.2979 A2.5,2.5 0 0 1 748,260.7979 L748,59.7979 A2.5,2.5 0 0 1 750.5,57.2979 " fill="#E8F5E9" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="748" x2="951.7114" y1="75.9468" y2="75.9468"/><text fill="#000000" font-family="Arial" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="190.7114" x="752" y="69.6157">Option B: 16384 slots (Redis choice)</text></g><!--entity sizeA--><g id="elem_sizeA"><rect fill="#FFCDD2" height="31.2979" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="103.4722" x="71.5" y="96.2979"/><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="58.6899" x="81.5" y="109.6157">Bitmap Size</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="55.3545" x="81.5" y="122.2646">65536 / 8 =</text><text fill="#000000" font-family="Arial" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="25.0615" x="139.9106" y="122.2646">8 KB</text></g><!--entity tcpA--><g id="elem_tcpA"><rect fill="#FFCDD2" height="31.2979" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="179.269" x="209.5" y="96.2979"/><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="64.1846" x="219.5" y="109.6157">TCP Packets</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="96.2876" x="219.5" y="122.2646">8KB / 1.5KB MTU =</text><text fill="#000000" font-family="Arial" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="59.9253" x="318.8438" y="122.2646">6-7 packets</text></g><!--entity memA--><g id="elem_memA"><rect fill="#FFCDD2" height="31.2979" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="175.9121" x="35" y="208.2979"/><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="155.9121" x="45" y="221.6157">Per-node memory (1000 nodes)</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="66.3545" x="45" y="234.2646">1000 x 8KB =</text><text fill="#000000" font-family="Arial" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="26.2808" x="114.4106" y="234.2646">8 MB</text></g><!--entity slotsA--><g id="elem_slotsA"><rect fill="#C8E6C9" height="31.2979" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="158.8159" x="246.5" y="208.2979"/><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="138.8159" x="256.5" y="221.6157">Slots per node (1000 nodes)</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="73.7075" x="256.5" y="234.2646">65536 / 1000 =</text><text fill="#000000" font-family="Arial" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="40.9653" x="333.2637" y="234.2646">65 slots</text></g><!--entity sizeB--><g id="elem_sizeB"><rect fill="#C8E6C9" height="31.2979" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="103.4722" x="808.5" y="96.2979"/><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="58.6899" x="818.5" y="109.6157">Bitmap Size</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="55.3545" x="818.5" y="122.2646">16384 / 8 =</text><text fill="#000000" font-family="Arial" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="25.0615" x="876.9106" y="122.2646">2 KB</text></g><!--entity tcpB--><g id="elem_tcpB"><rect fill="#C8E6C9" height="31.2979" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="169.4883" x="946.5" y="96.2979"/><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="64.1846" x="956.5" y="109.6157">TCP Packets</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="96.2876" x="956.5" y="122.2646">2KB / 1.5KB MTU =</text><text fill="#000000" font-family="Arial" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="50.1445" x="1055.8438" y="122.2646">2 packets</text></g><!--entity memB--><g id="elem_memB"><rect fill="#C8E6C9" height="31.2979" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="175.9121" x="772" y="208.2979"/><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="155.9121" x="782" y="221.6157">Per-node memory (1000 nodes)</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="66.3545" x="782" y="234.2646">1000 x 2KB =</text><text fill="#000000" font-family="Arial" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="26.2808" x="851.4106" y="234.2646">2 MB</text></g><!--entity slotsB--><g id="elem_slotsB"><rect fill="#C8E6C9" height="31.2979" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="158.8159" x="983.5" y="208.2979"/><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="138.8159" x="993.5" y="221.6157">Slots per node (1000 nodes)</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="73.7075" x="993.5" y="234.2646">16384 / 1000 =</text><text fill="#000000" font-family="Arial" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="40.9653" x="1070.2637" y="234.2646">16 slots</text></g><g id="elem_GMN12"><path d="M462,187.2979 L462,260.5425 L724.2319,260.5425 L724.2319,197.2979 L714.2319,187.2979 L462,187.2979 " fill="#FFEBEE" style="stroke:#000000;stroke-width:1.0;"/><path d="M714.2319,187.2979 L714.2319,197.2979 L724.2319,197.2979 L714.2319,187.2979 " fill="#FFEBEE" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Arial" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="89.8584" x="468" y="202.6157">Why NOT 65536?</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="165.7036" x="468" y="215.2646">- 4x bandwidth cost for heartbeats</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="222.2075" x="468" y="227.9136">- More TCP fragmentation = more retransmits</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="241.2319" x="468" y="240.5625">- 65 slots vs 16 slots per node = negligible benefit</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="3.6631" x="468" y="253.2114">-</text><text fill="#000000" font-family="Arial" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="94.7407" x="474.7192" y="253.2114">Over-engineering!</text></g><g id="elem_GMN15"><path d="M1199,187.2979 L1199,260.5425 L1418.7412,260.5425 L1418.7412,197.2979 L1408.7412,187.2979 L1199,187.2979 " fill="#E8F5E9" style="stroke:#000000;stroke-width:1.0;"/><path d="M1408.7412,187.2979 L1408.7412,197.2979 L1418.7412,197.2979 L1408.7412,187.2979 " fill="#E8F5E9" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Arial" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="63.583" x="1205" y="202.6157">Why 16384?</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="169.9575" x="1205" y="215.2646">- 2KB fits nicely in network packets</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="198.7412" x="1205" y="227.9136">- 16 slots/node is enough for rebalancing</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="187.6768" x="1205" y="240.5625">- Memory efficient for cluster metadata</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacing" textLength="3.6631" x="1205" y="253.2114">-</text><text fill="#000000" font-family="Arial" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="53.7754" x="1211.7192" y="253.2114">Just right!</text></g><!--link optionA to GMN12--><g id="link_optionA_GMN12"><path d="M438.2149,118.3388 C438.3052,118.3997 438.3961,118.461 438.4877,118.5228 C438.854,118.7701 439.2309,119.0243 439.6179,119.2855 C440.3921,119.8079 441.2071,120.3579 442.0608,120.9339 C448.8903,125.5425 458.1956,131.8222 468.8563,139.0166 C490.1775,153.4054 516.92,171.4529 540.12,187.1079 " fill="none" id="optionA-GMN12" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/></g><!--link optionB to GMN15--><g id="link_optionB_GMN15"><path d="M1175.1236,119.0909 C1175.2068,119.1554 1175.2906,119.2202 1175.3749,119.2855 C1176.0493,119.8079 1176.7594,120.3579 1177.5031,120.9339 C1183.4531,125.5425 1191.56,131.8222 1200.8475,139.0166 C1219.4225,153.4054 1242.72,171.4529 1262.93,187.1079 " fill="none" id="optionB-GMN15" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/></g><!--SRC=[ZPDTJzim58RlyoiES368r44ApGfIXKX89mtn8UYq6sxSv2InIEp8FkLZq_xxJfocer2cfHTfxEFNx_lOPujAh16QIaZbsGUf6c543NEHFXH6BrGMwqeRs9acxUzLHOQvM5GqrOgk12kS6IcgpVDtyYT247WUIQeGVfGl48I7uoEugpJPKvYL23CZCXpeF8UlhEPvds0ocK2iQrQJLglsqslObIWGjgyRaZnsTWBXQ7GOWcs5O3U-ZOCGyaLLWH6gmBrj41QqApxZ3DCaIXBuvG4_gJ0PR4UIQj50w_1UTLhxC8O9-FuOBYBVTmgMfztw-Fny-6hrBBw16_Q4PE_L-2BYjS7d4RylPz-THZZu0arNi9IYjDcaT8Dce7I6K6EjpGli1WS71z2EsBrxvJwUeTsXStRPE-FoJN8EB3HedCGRjJwc6tGkHnt0FctxdrNZSHB6nzvlxnttw6HvW4lkjvX92scfPRh6F8ATP3mT9SSVC-zqUkR3TURHoiG7p8SRc0_V4z-ayr_4XqlYmpNYc-J-IRmFkI8UXE-9Hw-9Aqq8SqsaQz3vsolC-_f-sqPNrxEk0qvzdmS7SFJChQko9vbH2Qcs13btRud2q1m5MLTqgGqt77FCZIXgL2JSgKwWRYSC4ZUFhUMokhyTy6YXz_qtw0GK5fKiv9mxUuuASqbkcUzVFp9YL8LKY4QgOeizeigWpVP1mjM5MILqwFfqxN6mlWN55wrw0QbuTthIvg4_SrVMkznt3lbcejABedGe3Cv59LJAVZeMtUbZdijKCWfNb5OBIvomHXAP8B4Cz8r7mSYYfBKeVm00]--></g></svg>